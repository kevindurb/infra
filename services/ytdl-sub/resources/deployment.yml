---
apiVersion: batch/v1
kind: CronJob
metadata:
  name: cron
spec:
  schedule: '0 * * * *'
  jobTemplate:
    spec:
      template:
        spec:
          restartPolicy: OnFailure
          containers:
            - name: ytdl-sub
              image: ghcr.io/jmbannon/ytdl-sub:2024.06.03
              workingDir: /config
              command:
                - ytdl-sub
                - sub
              env:
                - name: PUID
                  value: '1000'
                - name: PGID
                  value: '1000'
                - name: TZ
                  value: America/Denver
              volumeMounts:
                - name: media
                  mountPath: /movies
                  subPath: Movies
                - name: media
                  mountPath: /tv_shows
                  subPath: YouTube
                - name: media
                  mountPath: /music
                  subPath: Music
                - name: config-map
                  mountPath: /config/subscriptions.yaml
                  subPath: subscriptions.yml
          volumes:
            - name: media
              persistentVolumeClaim:
                claimName: truenas-media
            - name: config-map
              configMap:
                name: config
