# vim: set ft=yaml.ansible:
# yaml-language-server: $schema=https://raw.githubusercontent.com/ansible-community/schemas/main/f/ansible.json#/$defs/playbook
---
- hosts: homelab
  remote_user: kevindurb
  tasks:
    - name: dump db backup
      shell:
        cmd: 'docker-compose exec -T -e PG_PASSWORD -u postgres postgres pg_dumpall -h 127.0.0.1 > /tank/data/db.sql'
        chdir: ~/infra
        creates: /tank/data/db.sql

    - name: update healthchecks.io
      uri:
        url: '{{ healthcheck_url }}'
