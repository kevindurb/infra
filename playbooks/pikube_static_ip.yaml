# vim: set ft=yaml.ansible:
---
- hosts: pikubenodes
  become: true

  tasks:
    - name: Add static ip for interface
      when: network_system == "dhcpcd"
      ansible.builtin.template:
        src: ../files/dhcpcd.conf.j2
        dest: '/etc/dhcpcd.conf'

    - name: Set static ip with nmcli
      when: network_system == "nmcli"
      community.general.nmcli:
        state: present
        conn_name: eth1
        ifname: '{{ static_iface }}'
        type: ethernet
        ip4: '{{ static_ip }}/16'
        gw4: 192.168.1.1

    - name: Reboot
      ansible.builtin.reboot:
