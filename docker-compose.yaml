---
version: "3.8"
services:
  traefik:
    image: ghcr.io/kevindurb/infra_traefik
    environment:
      - CF_API_EMAIL
      - CF_DNS_API_TOKEN
    volumes:
      - traefik_acme:/etc/traefik/acme
    ports:
      - "443:443"
    restart: unless-stopped

  whoami:
    image: jwilder/whoami
    restart: unless-stopped

  grafana:
    image: ghcr.io/kevindurb/infra_grafana
    environment:
      GF_INSTALL_PLUGINS: flant-statusmap-panel,ae3e-plotly-panel
    volumes:
      - grafana:/var/lib/grafana
    restart: unless-stopped

  nodered:
    image: ghcr.io/kevindurb/infra_nodered
    volumes:
      - nodered:/data
    restart: unless-stopped

  freshrss:
    image: ghcr.io/kevindurb/infra_freshrss
    volumes:
      - freshrss:/config
    restart: unless-stopped

  prometheus:
    image: ghcr.io/kevindurb/infra_prometheus
    volumes:
      - prometheus:/prometheus
    restart: unless-stopped

  ping_exporter:
    image: ghcr.io/kevindurb/infra_ping_exporter
    restart: unless-stopped

  speedtest_exporter:
    image: miguelndecarvalho/speedtest-exporter
    restart: unless-stopped

  node_exporter:
    image: quay.io/prometheus/node-exporter:latest
    container_name: node_exporter
    command:
      - '--path.rootfs=/host'
    pid: host
    volumes:
      - '/:/host:ro,rslave'
    restart: unless-stopped

  syncthing:
    image: ghcr.io/linuxserver/syncthing
    ports:
      - 22000:22000/tcp
      - 22000:22000/udp
      - 21027:21027/udp

volumes:
  freshrss:
  nodered:
  prometheus:
  grafana:
  traefik_acme:
